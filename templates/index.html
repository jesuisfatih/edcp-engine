<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>S&S Activewear to Shopify Sync Panel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script>
        // CRITICAL: Define showSection IMMEDIATELY before any HTML uses it
        window.showSection = function(sectionName) {
            // This will be replaced by the full function when script.js loads
            console.log('showSection placeholder:', sectionName);
        };
    </script>
    <style>
        body {
            background-color: #f5f5f5;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .sidebar {
            min-height: 100vh;
            background: linear-gradient(180deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 0;
            position: fixed;
            width: 250px;
            z-index: 1000;
        }
        .sidebar-header {
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .sidebar-menu li {
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .sidebar-menu a {
            display: block;
            padding: 15px 20px;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s;
        }
        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background: rgba(255,255,255,0.1);
            color: white;
            padding-left: 25px;
        }
        .sidebar-menu a i {
            width: 25px;
            margin-right: 10px;
        }
        .main-content {
            margin-left: 250px;
            padding: 20px;
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .card {
            box-shadow: 0 2px 4px rgba(0,0,0,.1);
            border: none;
            margin-bottom: 20px;
        }
        .badge-status {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
        }
        .product-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            transition: background 0.3s;
        }
        .product-item:hover {
            background: #f8f9fa;
        }
        .progress-lg {
            height: 40px;
            font-size: 16px;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h4><i class="fas fa-sync-alt"></i> Sync Panel</h4>
        </div>
        <ul class="sidebar-menu">
            <li><a href="#" data-section="dashboard" class="active" id="menu-dashboard">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </a></li>
            <li><a href="#" data-section="settings" id="menu-settings">
                <i class="fas fa-cog"></i> API Ayarlarƒ±
            </a></li>
            <li><a href="#" data-section="sync-options" id="menu-sync-options">
                <i class="fas fa-sliders-h"></i> Aktarƒ±m Se√ßenekleri
            </a></li>
            <li><a href="#" data-section="sync-settings" id="menu-sync-settings">
                <i class="fas fa-tasks"></i> Aktarƒ±m Ayarlarƒ±
            </a></li>
            <li><a href="#" data-section="sync-active" id="menu-sync-active">
                <i class="fas fa-play-circle"></i> Aktarƒ±m
            </a></li>
            <li><a href="#" data-section="auto-sync" id="menu-auto-sync">
                <i class="fas fa-clock"></i> Otomatik G√ºncelleme
            </a></li>
            <li><a href="#" data-section="preview" id="menu-preview">
                <i class="fas fa-eye"></i> √úr√ºn √ñnizleme
            </a></li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Dashboard Section -->
        <div id="section-dashboard" class="content-section active">
            <h2 class="mb-4"><i class="fas fa-tachometer-alt"></i> Dashboard</h2>
            
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card text-center bg-primary text-white">
                        <div class="card-body">
                            <h3 id="stat-total">0</h3>
                            <p class="mb-0">Toplam √úr√ºn</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center bg-success text-white">
                        <div class="card-body">
                            <h3 id="stat-created">0</h3>
                            <p class="mb-0">Olu≈üturulan</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center bg-warning text-white">
                        <div class="card-body">
                            <h3 id="stat-updated">0</h3>
                            <p class="mb-0">G√ºncellenen</p>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center bg-danger text-white">
                        <div class="card-body">
                            <h3 id="stat-errors">0</h3>
                            <p class="mb-0">Hatalar</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h5>Son Aktarƒ±m Durumu</h5>
                </div>
                <div class="card-body">
                    <div id="dashboard-status">
                        <p class="text-muted">Hen√ºz aktarƒ±m yapƒ±lmadƒ±</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h5>Otomatik G√ºncelleme Durumu</h5>
                </div>
                <div class="card-body">
                    <div id="auto-sync-status-dashboard">
                        <p class="text-muted">Y√ºkleniyor...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- API Settings Section -->
        <div id="section-settings" class="content-section">
            <h2 class="mb-4"><i class="fas fa-cog"></i> API Ayarlarƒ±</h2>
            
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5>S&S Activewear API</h5>
                </div>
                <div class="card-body">
                    <form id="configForm">
                        <div class="mb-3">
                            <label class="form-label">Account Number</label>
                            <input type="text" class="form-control" id="ssAccountNumber" 
                                   placeholder="Your Account Number" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">API Key</label>
                            <input type="password" class="form-control" id="ssApiKey" 
                                   placeholder="Your API Key" required>
                            <small class="text-muted">
                                <a href="https://www.ssactivewear.com/api" target="_blank">Get API Key</a>
                            </small>
                        </div>

                        <h6 class="mt-4 mb-3">Shopify API</h6>
                        <div class="mb-3">
                            <label class="form-label">Shop Domain</label>
                            <input type="text" class="form-control" id="shopifyDomain" 
                                   placeholder="your-shop.myshopify.com" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Access Token</label>
                            <input type="password" class="form-control" id="shopifyToken" 
                                   placeholder="Your Admin API Access Token" required>
                            <small class="text-muted">Shopify Admin API 2025-01</small>
                        </div>

                        <button type="button" class="btn btn-info mb-2" onclick="testConnections()">
                            <i class="fas fa-plug"></i> Test Connections
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Configuration
                        </button>
                    </form>
                </div>
            </div>

            <div class="card" id="connectionResults" style="display: none;">
                <div class="card-header">
                    <h5>Connection Test Results</h5>
                </div>
                <div class="card-body" id="connectionResultsBody">
                </div>
            </div>
        </div>

        <!-- Sync Options Section -->
        <div id="section-sync-options" class="content-section">
            <h2 class="mb-4"><i class="fas fa-sliders-h"></i> Aktarƒ±m Se√ßenekleri</h2>
            
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5>Genel Se√ßenekler</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="syncAllProducts" checked>
                                <label class="form-check-label" for="syncAllProducts">
                                    T√ºm √úr√ºnleri Aktar
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="createNew" checked>
                                <label class="form-check-label" for="createNew">
                                    Yeni √úr√ºnler Olu≈ütur
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="updateExisting" checked>
                                <label class="form-check-label" for="updateExisting">
                                    Mevcut √úr√ºnleri G√ºncelle
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="syncCollections" checked>
                                <label class="form-check-label" for="syncCollections">
                                    Koleksiyonlarƒ± Aktar
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="createCollections" checked>
                                <label class="form-check-label" for="createCollections">
                                    Koleksiyon Yoksa Olu≈ütur
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="createBrandCollections" checked>
                                <label class="form-check-label" for="createBrandCollections">
                                    Marka Koleksiyonlarƒ± Olu≈ütur
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="syncTags" checked>
                                <label class="form-check-label" for="syncTags">
                                    Etiketleri Aktar
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="setActive" checked>
                                <label class="form-check-label" for="setActive">
                                    √úr√ºnleri Aktif Yap
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                    <h5><i class="fas fa-filter"></i> Multi-Step Filtreleme</h5>
                    <button type="button" class="btn btn-warning btn-sm" onclick="resetAllFilters()">
                        <i class="fas fa-redo"></i> Filtreleri Sƒ±fƒ±rla
                    </button>
                </div>
                <div class="card-body">
                    <!-- Step Indicator -->
                    <ul class="nav nav-pills mb-4" id="filterSteps" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="step1-tab" data-bs-toggle="pill" data-bs-target="#step1" type="button" role="tab">
                                <i class="fas fa-list"></i> 1. Kategoriler
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="step2-tab" data-bs-toggle="pill" data-bs-target="#step2" type="button" role="tab" disabled>
                                <i class="fas fa-tshirt"></i> 2. Stiller
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="step3-tab" data-bs-toggle="pill" data-bs-target="#step3" type="button" role="tab" disabled>
                                <i class="fas fa-tag"></i> 3. Markalar
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="step4-tab" data-bs-toggle="pill" data-bs-target="#step4" type="button" role="tab" disabled>
                                <i class="fas fa-eye"></i> 4. √ñnizleme + Lokasyon
                            </button>
                        </li>
                    </ul>

                    <!-- Step Content -->
                    <div class="tab-content" id="filterStepsContent">
                        <!-- Step 1: Categories -->
                        <div class="tab-pane fade show active" id="step1" role="tabpanel">
                            <div class="mb-3">
                                <button type="button" class="btn btn-primary mb-3" onclick="loadCategories()" id="loadCategoriesBtn">
                                    <i class="fas fa-sync"></i> Kategorileri Y√ºkle
                                </button>
                                <div class="mb-3">
                                    <input type="text" id="categorySearch" class="form-control" placeholder="üîç Kategori ara..." onkeyup="filterCategories()">
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="selectAllCategories" onchange="toggleAllCategories()">
                                    <label class="form-check-label fw-bold" for="selectAllCategories">
                                        T√ºm√ºn√º Se√ß
                                    </label>
                                </div>
                                <div id="categoriesList" class="border rounded p-3" style="max-height: 400px; overflow-y: auto;">
                                    <p class="text-muted text-center">Kategorileri y√ºklemek i√ßin yukarƒ±daki butona tƒ±klayƒ±n</p>
                                </div>
                                <div class="mt-3">
                                    <button type="button" class="btn btn-success" onclick="goToStep2()" id="step1NextBtn" disabled>
                                        ƒ∞leri: Stilleri Se√ß <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2: Styles -->
                        <div class="tab-pane fade" id="step2" role="tabpanel">
                            <div class="mb-3">
                                <p class="text-muted mb-3"><i class="fas fa-info-circle"></i> Stiller otomatik olarak y√ºkleniyor...</p>
                                <button type="button" class="btn btn-primary mb-3" onclick="loadStyles()" id="loadStylesBtn" style="display: none;">
                                    <i class="fas fa-sync"></i> Stilleri Yeniden Y√ºkle
                                </button>
                                <div class="mb-3">
                                    <input type="text" id="styleSearch" class="form-control" placeholder="üîç Stil ara (isim, part number, marka)..." onkeyup="filterStyles()">
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="selectAllStyles" onchange="toggleAllStyles()">
                                    <label class="form-check-label fw-bold" for="selectAllStyles">
                                        T√ºm√ºn√º Se√ß
                                    </label>
                                </div>
                                <div id="stylesList" class="border rounded p-3" style="max-height: 400px; overflow-y: auto;">
                                    <p class="text-muted text-center">√ñnce kategorileri se√ßin</p>
                                </div>
                                <div class="mt-3">
                                    <button type="button" class="btn btn-secondary" onclick="goToStep1()">
                                        <i class="fas fa-arrow-left"></i> Geri
                                    </button>
                                    <button type="button" class="btn btn-success" onclick="goToStep3()" id="step2NextBtn" disabled>
                                        ƒ∞leri: Markalarƒ± Se√ß <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Step 3: Brands -->
                        <div class="tab-pane fade" id="step3" role="tabpanel">
                            <div class="mb-3">
                                <button type="button" class="btn btn-primary mb-3" onclick="loadBrands()" id="loadBrandsBtn">
                                    <i class="fas fa-sync"></i> Markalarƒ± Y√ºkle
                                </button>
                                <div class="mb-3">
                                    <input type="text" id="brandSearch" class="form-control" placeholder="üîç Marka ara..." onkeyup="filterBrands()">
                                </div>
                                <div class="form-check mb-2">
                                    <input class="form-check-input" type="checkbox" id="selectAllBrands" onchange="toggleAllBrands()">
                                    <label class="form-check-label fw-bold" for="selectAllBrands">
                                        T√ºm√ºn√º Se√ß
                                    </label>
                                </div>
                                <div id="brandsList" class="border rounded p-3" style="max-height: 400px; overflow-y: auto;">
                                    <p class="text-muted text-center">√ñnce stilleri se√ßin</p>
                                </div>
                                <div class="mt-3">
                                    <button type="button" class="btn btn-secondary" onclick="goToStep2()">
                                        <i class="fas fa-arrow-left"></i> Geri
                                    </button>
                                    <button type="button" class="btn btn-success" onclick="goToStep4()" id="step3NextBtn" disabled>
                                        ƒ∞leri: Diƒüer Filtreler <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Step 4: Preview + Location Selection -->
                        <div class="tab-pane fade" id="step4" role="tabpanel">
                            <h5 class="mb-3">üìã √ñnizleme ve Lokasyon Se√ßimi</h5>
                            
                            <button type="button" class="btn btn-primary mb-3" id="loadPreviewBtn">
                                <i class="fas fa-sync"></i> √ñnizleme Y√ºkle
                            </button>
                            
                            <div class="alert alert-info">
                                <i class="fas fa-info-circle"></i>
                                <strong>√ñNEMLƒ∞:</strong> Se√ßtiƒüiniz √ºr√ºnler i√ßin lokasyon bazlƒ± stok durumu g√∂sterilecek.
                                En y√ºksek stoƒüu olan lokasyon otomatik se√ßilecek.
                            </div>
                            
                            <div id="previewWithLocations" class="border rounded p-3" style="max-height: 500px; overflow-y: auto;">
                                <p class="text-muted text-center">√ñnizleme y√ºklemek i√ßin yukarƒ±daki butona tƒ±klayƒ±n</p>
                            </div>
                            
                            <div class="mb-3 mt-3" id="locationSelectionSection" style="display:none;">
                                <h6>üìç Lokasyon Se√ßimi:</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="autoSelectHighestStock" checked>
                                    <label class="form-check-label" for="autoSelectHighestStock">
                                        ‚úÖ En √ßok stoƒüu olan lokasyonu otomatik se√ß
                                    </label>
                                </div>
                                <div id="locationsList" class="mt-2">
                                </div>
                            </div>
                            
                            <!-- Other filters moved here -->
                            <div class="row mt-4">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">Part Number Filtresi (opsiyonel)</label>
                                        <input type="text" class="form-control" id="filterPartNumber" 
                                               placeholder="√∂rn: 00760">
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label class="form-label">SKU/GTIN Filtresi</label>
                                        <input type="text" class="form-control" id="filterSku" 
                                               placeholder="√∂rn: B00760004">
                                        <small class="text-muted">Virg√ºlle ayƒ±rƒ±n</small>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-3">
                                <button type="button" class="btn btn-secondary" onclick="goToStep3()">
                                    <i class="fas fa-arrow-left"></i> Geri
                                </button>
                                <button type="button" class="btn btn-primary" onclick="saveFilters()">
                                    <i class="fas fa-check"></i> Filtreleri Kaydet ve Devam Et
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Save Transfer Settings Button -->
                    <div class="card mt-4">
                        <div class="card-body text-center">
                            <button type="button" class="btn btn-success btn-lg" onclick="saveTransferSettings()" id="saveTransferSettingsBtn">
                                <i class="fas fa-save"></i> Aktarƒ±m Ayarlarƒ±nƒ± Kaydet
                            </button>
                            <p class="text-muted mt-2 mb-0">T√ºm filtre ve ayarlarƒ± kaydedip aktarƒ±m i√ßin hazƒ±r hale getirin</p>
                        </div>
                    </div>

                    <!-- Selected Filters Summary -->
                    <div class="card mt-4" id="filtersSummary" style="display: none;">
                        <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                            <h6 class="mb-0"><i class="fas fa-list-check"></i> Se√ßilen Filtreler</h6>
                            <div>
                                <button type="button" class="btn btn-sm btn-warning me-2" onclick="editFilters()">
                                    <i class="fas fa-edit"></i> D√ºzenle
                                </button>
                                <button type="button" class="btn btn-sm btn-danger" onclick="clearFilters()">
                                    <i class="fas fa-trash"></i> Temizle
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div id="filtersSummaryContent"></div>
                            <div id="actualProductCount" class="mt-3 p-2 bg-light rounded" style="display: none;">
                                <p class="mb-0"><strong>Ger√ßek √úr√ºn Sayƒ±sƒ±:</strong> <span id="actualCountValue" class="badge bg-primary">Hesaplanƒ±yor...</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sync Settings Section -->
        <div id="section-sync-settings" class="content-section">
            <h2 class="mb-4"><i class="fas fa-tasks"></i> Aktarƒ±m Ayarlarƒ±</h2>
            
            <div class="card">
                <div class="card-header">
                    <h5>Geli≈ümi≈ü Ayarlar</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">Fiyat Alanƒ±</label>
                        <select class="form-select" id="priceField">
                            <option value="customerPrice">M√º≈üteri Fiyatƒ± (customerPrice)</option>
                            <option value="piecePrice">Par√ßa Fiyatƒ± (piecePrice)</option>
                            <option value="dozenPrice">D√ºzine Fiyatƒ± (dozenPrice)</option>
                            <option value="casePrice">Kasa Fiyatƒ± (casePrice)</option>
                            <option value="mapPrice">MAP Fiyatƒ± (mapPrice)</option>
                            <option value="salePrice">ƒ∞ndirimli Fiyat (salePrice)</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Envanter Y√∂netimi</label>
                        <select class="form-select" id="inventoryManagement">
                            <option value="shopify">Shopify Y√∂netimi</option>
                            <option value="not_managed">Y√∂netilmeyen</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">G√∂rsel Boyutu</label>
                        <select class="form-select" id="imageSize">
                            <option value="_fl">B√ºy√ºk (Large)</option>
                            <option value="_fm">Orta (Medium)</option>
                            <option value="_fs">K√º√ß√ºk (Small)</option>
                        </select>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="updateInventory" checked>
                        <label class="form-check-label" for="updateInventory">
                            Envanteri G√ºncelle
                        </label>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="updatePrices" checked>
                        <label class="form-check-label" for="updatePrices">
                            Fiyatlarƒ± G√ºncelle
                        </label>
                    </div>
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="updateImages" checked>
                        <label class="form-check-label" for="updateImages">
                            G√∂rselleri G√ºncelle
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sync Active Section -->
        <div id="section-sync-active" class="content-section">
            <h2 class="mb-4"><i class="fas fa-play-circle"></i> Aktarƒ±m</h2>
            
            <div class="card">
                <div class="card-header bg-dark text-white">
                    <h5>Aktarƒ±m Kontrol√º</h5>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-md-3">
                            <button class="btn btn-success btn-lg w-100" onclick="startSync()" id="startBtn" style="height: 60px;">
                                <i class="fas fa-play"></i> Aktarƒ±mƒ± Ba≈ülat
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-warning btn-lg w-100" onclick="stopSync()" id="stopBtn" disabled style="height: 60px;">
                                <i class="fas fa-stop"></i> Durdur
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-info btn-lg w-100" onclick="previewProducts()" style="height: 60px;">
                                <i class="fas fa-eye"></i> √ñnizleme
                            </button>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-danger btn-lg w-100" onclick="showRollbackLastSyncModal()" style="height: 60px;">
                                <i class="fas fa-undo"></i> Son Aktarƒ±mƒ± Geri Al
                            </button>
                        </div>
                    </div>
                    
                    <div class="row mb-3">
                        <div class="col-md-12">
                            <button class="btn btn-danger btn-lg w-100" onclick="showDeleteAllModal()" style="height: 60px;">
                                <i class="fas fa-trash-alt"></i> Shopify'daki T√ºm √úr√ºnleri/Markalarƒ±/Collectionlarƒ± Sil
                            </button>
                            <small class="text-danger d-block mt-2 text-center"><i class="fas fa-exclamation-triangle"></i> Dƒ∞KKAT: Bu i≈ülem geri alƒ±namaz!</small>
                        </div>
                    </div>

                    <div class="mb-3" id="progressSection" style="display: none;">
                        <div class="d-flex justify-content-between mb-2">
                            <span id="progressText">Ba≈ülatƒ±lƒ±yor...</span>
                            <span id="progressPercent">0%</span>
                        </div>
                        <div class="progress progress-lg">
                            <div class="progress-bar progress-bar-striped progress-bar-animated" 
                                 role="progressbar" id="progressBar" 
                                 style="width: 0%">0%</div>
                        </div>
                    </div>

                    <!-- Ultra Advanced Transfer Details Console -->
                    <div class="card mt-3" id="transferConsoleCard" style="display: none;">
                        <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0"><i class="fas fa-terminal"></i> Aktarƒ±m Detaylarƒ±</h5>
                            <button class="btn btn-sm btn-outline-light" onclick="clearConsole()">
                                <i class="fas fa-trash"></i> Temizle
                            </button>
                        </div>
                        <div class="card-body p-0">
                            <div id="transferConsole" class="console-output">
                                <div class="console-line">
                                    <span class="console-prompt">$</span>
                                    <span class="console-text">Aktarƒ±m ba≈ülatƒ±ldƒ±. Loglar burada g√∂r√ºnecek...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Created Products Links Section -->
                    <div class="card mt-3" id="createdProductsCard" style="display: none;">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0"><i class="fas fa-link"></i> Aktarƒ±lan √úr√ºnler ve Linkler</h5>
                        </div>
                        <div class="card-body">
                            <div id="createdProductsList">
                                <p class="text-muted">√úr√ºnler aktarƒ±ldƒ±ktan sonra burada g√∂r√ºnecek...</p>
                            </div>
                        </div>
                    </div>

                    <div id="statusAlertContainer"></div>
                </div>
            </div>

            <div class="card" id="currentProductCard" style="display: none;">
                <div class="card-header bg-primary text-white">
                    <h5>≈ûu Anda Aktarƒ±lan √úr√ºn</h5>
                </div>
                <div class="card-body">
                    <div id="currentProductInfo">
                        <p class="text-muted">Y√ºkleniyor...</p>
                    </div>
                    
                    <!-- NEW ARCHITECTURE: Step-by-step progress -->
                    <div class="mt-3">
                        <h6>ƒ∞≈ülem Adƒ±mlarƒ±</h6>
                        <div class="step-indicator">
                            <div class="step" id="step-fetch">
                                <i class="fas fa-download"></i>
                                <span>Veri √áekiliyor</span>
                            </div>
                            <div class="step" id="step-cache">
                                <i class="fas fa-database"></i>
                                <span>Veritabanƒ±na Kaydediliyor</span>
                            </div>
                            <div class="step" id="step-group">
                                <i class="fas fa-layer-group"></i>
                                <span>Gruplanƒ±yor</span>
                            </div>
                            <div class="step" id="step-sync">
                                <i class="fas fa-sync"></i>
                                <span>Shopify'a Aktarƒ±lƒ±yor</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h5>ƒ∞statistikler</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="card text-center bg-primary text-white">
                                <div class="card-body">
                                    <h3 id="statTotalActive">0</h3>
                                    <p class="mb-0">Toplam</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-center bg-success text-white">
                                <div class="card-body">
                                    <h3 id="statCreatedActive">0</h3>
                                    <p class="mb-0">Olu≈üturulan</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-center bg-warning text-white">
                                <div class="card-body">
                                    <h3 id="statUpdatedActive">0</h3>
                                    <p class="mb-0">G√ºncellenen</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card text-center bg-danger text-white">
                                <div class="card-body">
                                    <h3 id="statErrorsActive">0</h3>
                                    <p class="mb-0">Hatalar</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card" id="errorLog" style="display: none;">
                <div class="card-header bg-danger text-white">
                    <h5><i class="fas fa-exclamation-triangle"></i> Hata Loglarƒ±</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    <th>SKU</th>
                                    <th>Hata</th>
                                    <th>Zaman</th>
                                </tr>
                            </thead>
                            <tbody id="errorLogBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Auto Sync Section -->
        <div id="section-auto-sync" class="content-section">
            <h2 class="mb-4"><i class="fas fa-clock"></i> Otomatik G√ºncelleme</h2>
            
            <!-- Selected Filters Display -->
            <div class="card mb-4">
                <div class="card-header bg-warning text-dark">
                    <h5><i class="fas fa-filter"></i> Se√ßilen Filtreler (Otomatik Aktarƒ±m ƒ∞√ßin)</h5>
                </div>
                <div class="card-body">
                    <div id="autoSyncFiltersDisplay">
                        <p class="text-muted">Hen√ºz filtre se√ßilmedi. L√ºtfen √∂nce "Aktarƒ±m Se√ßenekleri" sekmesinden filtreleri se√ßin.</p>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5>Otomatik G√ºncelleme Ayarlarƒ±</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="autoSyncEnabled">
                            <label class="form-check-label" for="autoSyncEnabled">
                                <strong>Otomatik G√ºncellemeyi Etkinle≈ütir</strong>
                            </label>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">G√ºncelleme Aralƒ±ƒüƒ± (Saat)</label>
                        <input type="number" class="form-control" id="autoSyncInterval" value="12" min="1" max="168">
                        <small class="text-muted">12 saat = G√ºnde 2 kez g√ºncelleme</small>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="autoSyncRequireApproval" checked>
                            <label class="form-check-label" for="autoSyncRequireApproval">
                                G√ºncelleme √ñncesi Onay ƒ∞ste
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Auto Sync Options -->
            <div class="card mt-4">
                <div class="card-header bg-success text-white">
                    <h5><i class="fas fa-cog"></i> Otomatik Aktarƒ±m Se√ßenekleri</h5>
                </div>
                <div class="card-body">
                    <p class="text-muted mb-3">Otomatik g√ºncellemede hangi i≈ülemlerin yapƒ±lacaƒüƒ±nƒ± se√ßin:</p>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="autoSyncUpdateInventory" checked>
                                <label class="form-check-label" for="autoSyncUpdateInventory">
                                    <strong>Stok Miktarƒ±nƒ± G√ºncelle (Envanter)</strong>
                                    <br><small class="text-muted">Mevcut √ºr√ºnlerin stok miktarlarƒ±nƒ± g√ºnceller</small>
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="autoSyncUpdatePrices" checked>
                                <label class="form-check-label" for="autoSyncUpdatePrices">
                                    <strong>Fiyatlarƒ± G√ºncelle</strong>
                                    <br><small class="text-muted">Mevcut √ºr√ºnlerin fiyatlarƒ±nƒ± g√ºnceller</small>
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="autoSyncUpdateImages" checked>
                                <label class="form-check-label" for="autoSyncUpdateImages">
                                    <strong>G√∂rselleri G√ºncelle</strong>
                                    <br><small class="text-muted">Mevcut √ºr√ºnlerin g√∂rsellerini g√ºnceller</small>
                                </label>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="autoSyncCreateNew" checked>
                                <label class="form-check-label" for="autoSyncCreateNew">
                                    <strong>Yeni √úr√ºnler Ekle</strong>
                                    <br><small class="text-muted">Yeni √ºr√ºnleri Shopify'a ekler</small>
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="autoSyncUpdateExisting" checked>
                                <label class="form-check-label" for="autoSyncUpdateExisting">
                                    <strong>Mevcut √úr√ºnleri G√ºncelle</strong>
                                    <br><small class="text-muted">Mevcut √ºr√ºnlerin bilgilerini g√ºnceller</small>
                                </label>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="autoSyncUpdateCollections">
                                <label class="form-check-label" for="autoSyncUpdateCollections">
                                    <strong>Koleksiyonlarƒ± G√ºncelle</strong>
                                    <br><small class="text-muted">√úr√ºnlerin koleksiyon bilgilerini g√ºnceller</small>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info mt-3">
                        <i class="fas fa-info-circle"></i> <strong>Not:</strong> Bu se√ßenekler sadece otomatik g√ºncelleme i√ßin ge√ßerlidir. 
                        Manuel aktarƒ±mda t√ºm se√ßenekler "Aktarƒ±m Se√ßenekleri" sekmesinden kontrol edilir.
                    </div>
                    
                    <button class="btn btn-primary btn-lg" onclick="saveAutoSyncSettings()">
                        <i class="fas fa-save"></i> Otomatik G√ºncelleme Ayarlarƒ±nƒ± Kaydet
                    </button>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h5>Otomatik G√ºncelleme Durumu</h5>
                </div>
                <div class="card-body" id="autoSyncStatus">
                    <p class="text-muted">Y√ºkleniyor...</p>
                </div>
            </div>

            <div class="card" id="pendingApprovalCard" style="display: none;">
                <div class="card-header bg-warning">
                    <h5>Onay Bekleyen G√ºncelleme</h5>
                </div>
                <div class="card-body">
                    <p>Otomatik g√ºncelleme ba≈ülatƒ±lmak i√ßin onay bekliyor.</p>
                    <button class="btn btn-success" onclick="approveAutoSync()">
                        <i class="fas fa-check"></i> Onayla ve Ba≈ülat
                    </button>
                    <button class="btn btn-danger" onclick="rejectAutoSync()">
                        <i class="fas fa-times"></i> Reddet
                    </button>
                </div>
            </div>
        </div>

        <!-- Preview Section -->
        <div id="section-preview" class="content-section">
            <h2 class="mb-4"><i class="fas fa-eye"></i> √úr√ºn √ñnizleme</h2>
            
            <div class="card">
                <div class="card-header">
                    <h5>√úr√ºn √ñnizleme</h5>
                </div>
                <div class="card-body">
                    <button class="btn btn-primary mb-3" onclick="previewProducts()">
                        <i class="fas fa-sync"></i> √úr√ºnleri Y√ºkle
                    </button>
                    <div class="table-responsive">
                        <table class="table table-striped" id="previewTable">
                            <thead>
                                <tr>
                                    <th>SKU</th>
                                    <th>Marka</th>
                                    <th>Stil</th>
                                    <th>Renk</th>
                                    <th>Beden</th>
                                    <th>Fiyat</th>
                                    <th>Stok</th>
                                </tr>
                            </thead>
                            <tbody id="previewTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Rollback Last Sync Modal -->
    <div class="modal fade" id="rollbackLastSyncModal" tabindex="-1" aria-labelledby="rollbackLastSyncModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-warning">
                    <h5 class="modal-title" id="rollbackLastSyncModalLabel">
                        <i class="fas fa-exclamation-triangle"></i> Son Aktarƒ±mƒ± Geri Al
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p><strong>Bu i≈ülem son aktarƒ±mda olu≈üturulan √ºr√ºnleri silecektir.</strong></p>
                    <p>G√ºncellenen √ºr√ºnler otomatik olarak geri alƒ±namaz (eski veriler kaydedilmedi).</p>
                    <p class="text-danger"><i class="fas fa-exclamation-triangle"></i> Bu i≈ülem geri alƒ±namaz!</p>
                    <div class="form-check mt-3">
                        <input class="form-check-input" type="checkbox" id="confirmRollback">
                        <label class="form-check-label" for="confirmRollback">
                            Son aktarƒ±mƒ± geri almak istediƒüimi onaylƒ±yorum
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒ∞ptal</button>
                    <button type="button" class="btn btn-danger" onclick="rollbackLastSync()" id="rollbackConfirmBtn" disabled>
                        <i class="fas fa-undo"></i> Geri Al
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Delete All Modal -->
    <div class="modal fade" id="deleteAllModal" tabindex="-1" aria-labelledby="deleteAllModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="deleteAllModalLabel">
                        <i class="fas fa-exclamation-triangle"></i> T√ºm Shopify Verilerini Sil
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="alert alert-danger">
                        <h6><i class="fas fa-exclamation-triangle"></i> Dƒ∞KKAT: Bu i≈ülem geri alƒ±namaz!</h6>
                        <p>Bu i≈ülem Shopify maƒüazanƒ±zdaki <strong>T√úM</strong> a≈üaƒüƒ±daki verileri silecektir:</p>
                        <ul>
                            <li><strong>T√ºm √úr√ºnler</strong> - T√ºm √ºr√ºnler ve varyantlarƒ± kalƒ±cƒ± olarak silinecek</li>
                            <li><strong>T√ºm Collectionlar</strong> - T√ºm koleksiyonlar (marka, kategori vb.) silinecek</li>
                        </ul>
                        <p class="mb-0"><strong>Bu i≈ülem geri alƒ±namaz ve t√ºm veriler kalƒ±cƒ± olarak kaybolacaktƒ±r!</strong></p>
                    </div>
                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="deleteProductsCheck" checked>
                            <label class="form-check-label" for="deleteProductsCheck">
                                √úr√ºnleri Sil
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="deleteCollectionsCheck" checked>
                            <label class="form-check-label" for="deleteCollectionsCheck">
                                Collectionlarƒ± Sil
                            </label>
                        </div>
                    </div>
                    <div class="form-check mt-3">
                        <input class="form-check-input" type="checkbox" id="confirmDeleteAll">
                        <label class="form-check-label" for="confirmDeleteAll">
                            <strong>T√ºm Shopify verilerini silmek istediƒüimi onaylƒ±yorum</strong>
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ƒ∞ptal</button>
                    <button type="button" class="btn btn-danger" onclick="deleteAllShopifyData()" id="deleteAllConfirmBtn" disabled>
                        <i class="fas fa-trash-alt"></i> T√ºm√ºn√º Sil
                    </button>
                </div>
            </div>
        </div>
    </div>
    <script src="{{ url_for('static', filename='warehouse_ui.js') }}"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>

